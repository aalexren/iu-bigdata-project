{"paragraphs":[{"text":"%python2\n\nfrom pyspark.sql import SparkSession\n\n\nspark = SparkSession.builder\\\n    .appName(\"BDT Project\")\\\n    .master(\"local[4]\")\\\n    .config(\"spark.driver.memory\", \"2g\") \\\n    .config(\"hive.metastore.uris\", \"thrift://sandbox-hdp.hortonworks.com:9083\")\\\n    .config(\"spark.sql.catalogImplementation\",\"hive\")\\\n    .config(\"spark.sql.avro.compression.codec\", \"snappy\")\\\n    .config(\"spark.jars\", \"file:///usr/hdp/current/hive-client/lib/hive-metastore-1.2.1000.2.6.5.0-292.jar,file:///usr/hdp/current/hive-client/lib/hive-exec-1.2.1000.2.6.5.0-292.jar\")\\\n    .config(\"spark.jars.packages\",\"org.apache.spark:spark-avro_2.12:3.0.3\")\\\n    .enableHiveSupport()\\\n    .getOrCreate()\n\n\nsc = spark.sparkContext\n\nprint(sc)","user":"anonymous","dateUpdated":"2023-05-11T03:54:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... ... ... ... ... Warning: Ignoring non-Spark config property: hive.metastore.uris\nIvy Default Cache set to: /home/zeppelin/.ivy2/cache\nThe jars for the packages stored in: /home/zeppelin/.ivy2/jars\n:: loading settings :: url = jar:file:/usr/lib/python2.7/site-packages/pyspark/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml\norg.apache.spark#spark-avro_2.12 added as a dependency\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-774cffdc-7ca5-4cf2-bb2b-e604908e1e21;1.0\n\tconfs: [default]\n\tfound org.apache.spark#spark-avro_2.12;3.0.3 in central\n\tfound org.spark-project.spark#unused;1.0.0 in central\n:: resolution report :: resolve 910ms :: artifacts dl 22ms\n\t:: modules in use:\n\torg.apache.spark#spark-avro_2.12;3.0.3 from central in [default]\n\torg.spark-project.spark#unused;1.0.0 from central in [default]\n\t---------------------------------------------------------------------\n\t|                  |            modules            ||   artifacts   |\n\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|\n\t---------------------------------------------------------------------\n\t|      default     |   2   |   0   |   0   |   0   ||   2   |   0   |\n\t---------------------------------------------------------------------\n:: retrieving :: org.apache.spark#spark-submit-parent-774cffdc-7ca5-4cf2-bb2b-e604908e1e21\n\tconfs: [default]\n\t0 artifacts copied, 2 already retrieved (0kB/7ms)\n23/05/11 03:54:17 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n/usr/lib/python2.7/site-packages/pyspark/context.py:227: DeprecationWarning: Support for Python 2 and Python 3 prior to version 3.6 is deprecated as of Spark 3.0. See also the plan for dropping Python 2 support at https://spark.apache.org/news/plan-for-dropping-python-2-support.html.\n  DeprecationWarning)\n<SparkContext master=local[4] appName=BDT Project>\n"}]},"apps":[],"jobName":"paragraph_1683548473061_-995348512","id":"20230508-122113_2089722828","dateCreated":"2023-05-08T12:21:13+0000","dateStarted":"2023-05-11T03:54:03+0000","dateFinished":"2023-05-11T03:54:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:325"},{"text":"%python2\n\nprint(spark.catalog.listDatabases())","user":"anonymous","dateUpdated":"2023-05-11T04:13:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n                                                                                \n[Database(name=u'default', description=u'Default Hive database', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse'), Database(name=u'foodmart', description=u'', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse/foodmart.db'), Database(name=u'projectdb', description=u'', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse/projectdb.db')]\n"}]},"apps":[],"jobName":"paragraph_1683550780551_1225881865","id":"20230508-125940_1751226477","dateCreated":"2023-05-08T12:59:40+0000","dateStarted":"2023-05-11T04:13:39+0000","dateFinished":"2023-05-11T04:13:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:326"},{"text":"%python2\n\nprint(spark.catalog.listTables(\"projectdb\"))","user":"anonymous","dateUpdated":"2023-05-11T04:13:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Table(name=u'application_data', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'application_data_part', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'previous_application', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'previous_application_part', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'app_data', database=None, description=None, tableType=u'TEMPORARY', isTemporary=True), Table(name=u'prev_app', database=None, description=None, tableType=u'TEMPORARY', isTemporary=True)]\n"}]},"apps":[],"jobName":"paragraph_1683550786899_1613339332","id":"20230508-125946_332981643","dateCreated":"2023-05-08T12:59:46+0000","dateStarted":"2023-05-11T04:13:46+0000","dateFinished":"2023-05-11T04:13:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:327"},{"text":"%python2\n\napp_data = spark.read.format(\"avro\").table('projectdb.application_data')\napp_data.createOrReplaceTempView('app_data')\n\nprev_app = spark.read.format(\"avro\").table('projectdb.previous_application')\nprev_app.createOrReplaceTempView('prev_app')","user":"anonymous","dateUpdated":"2023-05-11T04:33:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1683550805314_386775162","id":"20230508-130005_1129292639","dateCreated":"2023-05-08T13:00:05+0000","dateStarted":"2023-05-11T04:33:58+0000","dateFinished":"2023-05-11T04:33:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:328"},{"text":"%python2\n\napp_data.printSchema()","user":"anonymous","dateUpdated":"2023-05-10T16:22:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683550966646_-2009812057","id":"20230508-130246_1833070088","dateCreated":"2023-05-08T13:02:46+0000","dateStarted":"2023-05-10T16:22:31+0000","dateFinished":"2023-05-10T16:22:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:329"},{"text":"%python2\n\nprev_app.printSchema()","user":"anonymous","dateUpdated":"2023-05-10T16:22:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683550975429_-1009449592","id":"20230508-130255_1787995386","dateCreated":"2023-05-08T13:02:55+0000","dateStarted":"2023-05-10T16:22:41+0000","dateFinished":"2023-05-10T16:22:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:330"},{"text":"%python2\n\nspark.sql(\"SELECT COUNT(1) FROM app_data WHERE obs_30_cnt_social_circle IS NULL;\").show()","user":"anonymous","dateUpdated":"2023-05-10T23:51:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 9:>                                                          (0 + 1) / 1]\n\n                                                                                \n+--------+\n|count(1)|\n+--------+\n|    1021|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1683551023256_1879321770","id":"20230508-130343_837535890","dateCreated":"2023-05-08T13:03:43+0000","dateStarted":"2023-05-10T23:51:19+0000","dateFinished":"2023-05-10T23:51:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%python2\n\nimport pyspark.sql.functions as F\n\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.ml.feature import StringIndexer, Imputer, MinMaxScaler, VectorAssembler\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator\nfrom pyspark.ml.classification import LogisticRegression, DecisionTreeClassifier","user":"anonymous","dateUpdated":"2023-05-11T03:54:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1683715070014_-727273109","id":"20230510-103750_405176176","dateCreated":"2023-05-10T10:37:50+0000","dateStarted":"2023-05-11T03:55:15+0000","dateFinished":"2023-05-11T03:55:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"%md\n\n\n### Preprocessing","user":"anonymous","dateUpdated":"2023-05-09T19:31:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Preprocessing</h3>\n"}]},"apps":[],"jobName":"paragraph_1683660702638_-1799138701","id":"20230509-193142_898784256","dateCreated":"2023-05-09T19:31:42+0000","dateStarted":"2023-05-09T19:31:53+0000","dateFinished":"2023-05-09T19:31:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"%md\n\n#### Encode categorical features","user":"anonymous","dateUpdated":"2023-05-10T11:09:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Encode categorical features</h4>\n"}]},"apps":[],"jobName":"paragraph_1683716937047_1109399360","id":"20230510-110857_914566055","dateCreated":"2023-05-10T11:08:57+0000","dateStarted":"2023-05-10T11:09:07+0000","dateFinished":"2023-05-10T11:09:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"%python2\n\napp_data.limit(5).show()","user":"anonymous","dateUpdated":"2023-05-11T04:34:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+------+------------------+-----------+------------+---------------+------------+----------------+----------+-----------+---------------+---------------+----------------+--------------------+--------------------+-----------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+---------------+--------------------+---------------------------+--------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+--------------------+-------------------+------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+------------------+--------------+--------------+------------------+-------------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+\n|sk_id_curr|target|name_contract_type|code_gender|flag_own_car|flag_own_realty|cnt_children|amt_income_total|amt_credit|amt_annuity|amt_goods_price|name_type_suite|name_income_type| name_education_type|  name_family_status|name_housing_type|region_population_relative|days_birth|days_employed|days_registration|days_id_publish|own_car_age|flag_mobil|flag_emp_phone|flag_work_phone|flag_cont_mobile|flag_phone|flag_email|occupation_type|cnt_fam_members|region_rating_client|region_rating_client_w_city|weekday_appr_process_start|hour_appr_process_start|reg_region_not_live_region|reg_region_not_work_region|live_region_not_work_region|reg_city_not_live_city|reg_city_not_work_city|live_city_not_work_city|   organization_type|       ext_source_1|      ext_source_2|       ext_source_3|apartments_avg|basementarea_avg|years_beginexpluatation_avg|   years_build_avg|commonarea_avg|elevators_avg|entrances_avg|floorsmax_avg|floorsmin_avg|landarea_avg|livingapartments_avg|livingarea_avg|nonlivingapartments_avg|nonlivingarea_avg|apartments_mode|basementarea_mode|years_beginexpluatation_mode|years_build_mode|commonarea_mode|elevators_mode|entrances_mode|floorsmax_mode|floorsmin_mode|landarea_mode|livingapartments_mode|livingarea_mode|nonlivingapartments_mode|nonlivingarea_mode|apartments_medi|basementarea_medi|years_beginexpluatation_medi|years_build_medi|commonarea_medi|elevators_medi|entrances_medi|floorsmax_medi|floorsmin_medi|landarea_medi|livingapartments_medi|livingarea_medi|nonlivingapartments_medi|nonlivingarea_medi|fondkapremont_mode|housetype_mode|totalarea_mode|wallsmaterial_mode|emergencystate_mode|obs_30_cnt_social_circle|def_30_cnt_social_circle|obs_60_cnt_social_circle|def_60_cnt_social_circle|days_last_phone_change|flag_document_2|flag_document_3|flag_document_4|flag_document_5|flag_document_6|flag_document_7|flag_document_8|flag_document_9|flag_document_10|flag_document_11|flag_document_12|flag_document_13|flag_document_14|flag_document_15|flag_document_16|flag_document_17|flag_document_18|flag_document_19|flag_document_20|flag_document_21|amt_req_credit_bureau_hour|amt_req_credit_bureau_day|amt_req_credit_bureau_week|amt_req_credit_bureau_mon|amt_req_credit_bureau_qrt|amt_req_credit_bureau_year|\n+----------+------+------------------+-----------+------------+---------------+------------+----------------+----------+-----------+---------------+---------------+----------------+--------------------+--------------------+-----------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+---------------+--------------------+---------------------------+--------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+--------------------+-------------------+------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+------------------+--------------+--------------+------------------+-------------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+\n|    100002|     1|        Cash loans|          M|           N|              Y|           0|        202500.0|  406597.5|    24700.5|       351000.0|  Unaccompanied|         Working|Secondary / secon...|Single / not married|House / apartment|                  0.018801|     -9461|         -637|          -3648.0|          -2120|       null|         1|             1|              0|               1|         1|         0|       Laborers|            1.0|                   2|                          2|                 WEDNESDAY|                     10|                         0|                         0|                          0|                     0|                     0|                      0|Business Entity T...|0.08303696739132256|0.2629485927471776|0.13937578009978951|        0.0247|          0.0369|                     0.9722|            0.6192|        0.0143|          0.0|        0.069|       0.0833|        0.125|      0.0369|              0.0202|         0.019|                    0.0|              0.0|         0.0252|           0.0383|                      0.9722|          0.6341|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0377|                0.022|         0.0198|                     0.0|               0.0|          0.025|           0.0369|                      0.9722|          0.6243|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0375|               0.0205|         0.0193|                     0.0|               0.0|  reg oper account|block of flats|        0.0149|      Stone, brick|                 No|                     2.0|                     2.0|                     2.0|                     2.0|               -1134.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       1.0|\n|    100003|     0|        Cash loans|          F|           N|              N|           0|        270000.0| 1293502.5|    35698.5|      1129500.0|         Family|   State servant|    Higher education|             Married|House / apartment|      0.003540999999999999|    -16765|        -1188|          -1186.0|           -291|       null|         1|             1|              0|               1|         1|         0|     Core staff|            2.0|                   1|                          1|                    MONDAY|                     11|                         0|                         0|                          0|                     0|                     0|                      0|              School| 0.3112673113812225|0.6222457752555098|               null|        0.0959|          0.0529|                     0.9851|0.7959999999999999|        0.0605|         0.08|       0.0345|       0.2917|       0.3333|       0.013|              0.0773|        0.0549|                 0.0039|           0.0098|         0.0924|           0.0538|                      0.9851|           0.804|         0.0497|        0.0806|        0.0345|        0.2917|        0.3333|       0.0128|                0.079|         0.0554|                     0.0|               0.0|         0.0968|           0.0529|                      0.9851|          0.7987|         0.0608|          0.08|        0.0345|        0.2917|        0.3333|       0.0132|               0.0787|         0.0558|                  0.0039|              0.01|  reg oper account|block of flats|        0.0714|             Block|                 No|                     1.0|                     0.0|                     1.0|                     0.0|                -828.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|\n|    100004|     0|   Revolving loans|          M|           Y|              Y|           0|         67500.0|  135000.0|     6750.0|       135000.0|  Unaccompanied|         Working|Secondary / secon...|Single / not married|House / apartment|                  0.010032|    -19046|         -225|          -4260.0|          -2531|       26.0|         1|             1|              1|               1|         1|         0|       Laborers|            1.0|                   2|                          2|                    MONDAY|                      9|                         0|                         0|                          0|                     0|                     0|                      0|          Government|               null|0.5559120833904428| 0.7295666907060153|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|              null|          null|          null|              null|               null|                     0.0|                     0.0|                     0.0|                     0.0|                -815.0|              0|              0|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|\n|    100006|     0|        Cash loans|          F|           N|              Y|           0|        135000.0|  312682.5|    29686.5|       297000.0|  Unaccompanied|         Working|Secondary / secon...|      Civil marriage|House / apartment|                  0.008019|    -19005|        -3039|          -9833.0|          -2437|       null|         1|             1|              0|               1|         0|         0|       Laborers|            2.0|                   2|                          2|                 WEDNESDAY|                     17|                         0|                         0|                          0|                     0|                     0|                      0|Business Entity T...|               null|0.6504416904014653|               null|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|              null|          null|          null|              null|               null|                     2.0|                     0.0|                     2.0|                     0.0|                -617.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                      null|                     null|                      null|                     null|                     null|                      null|\n|    100007|     0|        Cash loans|          M|           N|              Y|           0|        121500.0|  513000.0|    21865.5|       513000.0|  Unaccompanied|         Working|Secondary / secon...|Single / not married|House / apartment|                  0.028663|    -19932|        -3038|          -4311.0|          -3458|       null|         1|             1|              0|               1|         0|         0|     Core staff|            1.0|                   2|                          2|                  THURSDAY|                     11|                         0|                         0|                          0|                     0|                     1|                      1|            Religion|               null|0.3227382869704046|               null|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|              null|          null|          null|              null|               null|                     0.0|                     0.0|                     0.0|                     0.0|               -1106.0|              0|              0|              0|              0|              0|              0|              1|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|\n+----------+------+------------------+-----------+------------+---------------+------------+----------------+----------+-----------+---------------+---------------+----------------+--------------------+--------------------+-----------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+---------------+--------------------+---------------------------+--------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+--------------------+-------------------+------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+------------------+--------------+--------------+------------------+-------------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683779646433_1843223837","id":"20230511-043406_1826785954","dateCreated":"2023-05-11T04:34:06+0000","dateStarted":"2023-05-11T04:34:19+0000","dateFinished":"2023-05-11T04:34:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"categorical_features = [\n    \"name_contract_type\",\n    \"code_gender\",\n    \"flag_own_car\",\n    \"flag_own_realty\",\n    \"name_type_suite\",\n    \"name_income_type\",\n    \"name_education_type\",\n    \"name_family_status\",\n    \"name_housing_type\",\n    \"occupation_type\",\n    \"weekday_appr_process_start\",\n    \"organization_type\",\n    \"fondkapremont_mode\",\n    \"housetype_mode\",\n    \"wallsmaterial_mode\",\n    \"emergencystate_mode\"\n]\n\nfor feature in categorical_features:\n    indexer = StringIndexer(\n        inputCol=feature,\n        outputCol=\"%s_enc\" % feature\n    )\n    indexer = indexer.setHandleInvalid(\"keep\")\n    indexer = indexer.fit(app_data)\n    app_data = indexer.transform(app_data)\n\napp_data = app_data.drop(*categorical_features)\n\napp_data.limit(10).show()","user":"anonymous","dateUpdated":"2023-05-11T04:34:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... \n[Stage 85:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 87:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 89:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 91:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 93:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 95:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 97:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 99:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 101:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 103:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 105:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 107:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 109:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 111:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 113:>                                                        (0 + 1) / 1]\n\n[Stage 113:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 115:>                                                        (0 + 1) / 1]\n\n[Stage 115:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 117:>                                                        (0 + 1) / 1]\n\n                                                                                \n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+-------------------+-------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n|sk_id_curr|target|cnt_children|amt_income_total|amt_credit|amt_annuity|amt_goods_price|region_population_relative|days_birth|days_employed|days_registration|days_id_publish|own_car_age|flag_mobil|flag_emp_phone|flag_work_phone|flag_cont_mobile|flag_phone|flag_email|cnt_fam_members|region_rating_client|region_rating_client_w_city|hour_appr_process_start|reg_region_not_live_region|reg_region_not_work_region|live_region_not_work_region|reg_city_not_live_city|reg_city_not_work_city|live_city_not_work_city|       ext_source_1|       ext_source_2|       ext_source_3|apartments_avg|basementarea_avg|years_beginexpluatation_avg|   years_build_avg|commonarea_avg|elevators_avg|entrances_avg|floorsmax_avg|floorsmin_avg|landarea_avg|livingapartments_avg|livingarea_avg|nonlivingapartments_avg|nonlivingarea_avg|apartments_mode|basementarea_mode|years_beginexpluatation_mode|years_build_mode|commonarea_mode|elevators_mode|entrances_mode|floorsmax_mode|floorsmin_mode|landarea_mode|livingapartments_mode|livingarea_mode|nonlivingapartments_mode|nonlivingarea_mode|apartments_medi|basementarea_medi|years_beginexpluatation_medi|years_build_medi|commonarea_medi|elevators_medi|entrances_medi|floorsmax_medi|floorsmin_medi|landarea_medi|livingapartments_medi|livingarea_medi|nonlivingapartments_medi|nonlivingarea_medi|totalarea_mode|obs_30_cnt_social_circle|def_30_cnt_social_circle|obs_60_cnt_social_circle|def_60_cnt_social_circle|days_last_phone_change|flag_document_2|flag_document_3|flag_document_4|flag_document_5|flag_document_6|flag_document_7|flag_document_8|flag_document_9|flag_document_10|flag_document_11|flag_document_12|flag_document_13|flag_document_14|flag_document_15|flag_document_16|flag_document_17|flag_document_18|flag_document_19|flag_document_20|flag_document_21|amt_req_credit_bureau_hour|amt_req_credit_bureau_day|amt_req_credit_bureau_week|amt_req_credit_bureau_mon|amt_req_credit_bureau_qrt|amt_req_credit_bureau_year|name_contract_type_enc|code_gender_enc|flag_own_car_enc|flag_own_realty_enc|name_type_suite_enc|name_income_type_enc|name_education_type_enc|name_family_status_enc|name_housing_type_enc|occupation_type_enc|weekday_appr_process_start_enc|organization_type_enc|fondkapremont_mode_enc|housetype_mode_enc|wallsmaterial_mode_enc|emergencystate_mode_enc|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+-------------------+-------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n|    100002|     1|           0|        202500.0|  406597.5|    24700.5|       351000.0|                  0.018801|     -9461|         -637|          -3648.0|          -2120|       null|         1|             1|              0|               1|         1|         0|            1.0|                   2|                          2|                     10|                         0|                         0|                          0|                     0|                     0|                      0|0.08303696739132256| 0.2629485927471776|0.13937578009978951|        0.0247|          0.0369|                     0.9722|            0.6192|        0.0143|          0.0|        0.069|       0.0833|        0.125|      0.0369|              0.0202|         0.019|                    0.0|              0.0|         0.0252|           0.0383|                      0.9722|          0.6341|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0377|                0.022|         0.0198|                     0.0|               0.0|          0.025|           0.0369|                      0.9722|          0.6243|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0375|               0.0205|         0.0193|                     0.0|               0.0|        0.0149|                     2.0|                     2.0|                     2.0|                     2.0|               -1134.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       1.0|                   0.0|            1.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                0.0|                           1.0|                  0.0|                   0.0|               0.0|                   1.0|                    0.0|\n|    100003|     0|           0|        270000.0| 1293502.5|    35698.5|      1129500.0|      0.003540999999999999|    -16765|        -1188|          -1186.0|           -291|       null|         1|             1|              0|               1|         1|         0|            2.0|                   1|                          1|                     11|                         0|                         0|                          0|                     0|                     0|                      0| 0.3112673113812225| 0.6222457752555098|               null|        0.0959|          0.0529|                     0.9851|0.7959999999999999|        0.0605|         0.08|       0.0345|       0.2917|       0.3333|       0.013|              0.0773|        0.0549|                 0.0039|           0.0098|         0.0924|           0.0538|                      0.9851|           0.804|         0.0497|        0.0806|        0.0345|        0.2917|        0.3333|       0.0128|                0.079|         0.0554|                     0.0|               0.0|         0.0968|           0.0529|                      0.9851|          0.7987|         0.0608|          0.08|        0.0345|        0.2917|        0.3333|       0.0132|               0.0787|         0.0558|                  0.0039|              0.01|        0.0714|                     1.0|                     0.0|                     1.0|                     0.0|                -828.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|                   0.0|            0.0|             0.0|                1.0|                1.0|                 3.0|                    1.0|                   0.0|                  0.0|                2.0|                           2.0|                  7.0|                   0.0|               0.0|                   2.0|                    0.0|\n|    100004|     0|           0|         67500.0|  135000.0|     6750.0|       135000.0|                  0.010032|    -19046|         -225|          -4260.0|          -2531|       26.0|         1|             1|              1|               1|         1|         0|            1.0|                   2|                          2|                      9|                         0|                         0|                          0|                     0|                     0|                      0|               null| 0.5559120833904428| 0.7295666907060153|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     0.0|                     0.0|                     0.0|                     0.0|                -815.0|              0|              0|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|                   1.0|            1.0|             1.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                0.0|                           2.0|                  6.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100006|     0|           0|        135000.0|  312682.5|    29686.5|       297000.0|                  0.008019|    -19005|        -3039|          -9833.0|          -2437|       null|         1|             1|              0|               1|         0|         0|            2.0|                   2|                          2|                     17|                         0|                         0|                          0|                     0|                     0|                      0|               null| 0.6504416904014653|               null|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     2.0|                     0.0|                     2.0|                     0.0|                -617.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                      null|                     null|                      null|                     null|                     null|                      null|                   0.0|            0.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   2.0|                  0.0|                0.0|                           1.0|                  0.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100007|     0|           0|        121500.0|  513000.0|    21865.5|       513000.0|                  0.028663|    -19932|        -3038|          -4311.0|          -3458|       null|         1|             1|              0|               1|         0|         0|            1.0|                   2|                          2|                     11|                         0|                         0|                          0|                     0|                     1|                      1|               null| 0.3227382869704046|               null|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     0.0|                     0.0|                     0.0|                     0.0|               -1106.0|              0|              0|              0|              0|              0|              0|              1|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|                   0.0|            1.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                2.0|                           3.0|                 53.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100008|     0|           0|         99000.0|  490495.5|    27517.5|       454500.0|      0.035792000000000004|    -16941|        -1588|          -4970.0|           -477|       null|         1|             1|              1|               1|         1|         0|            2.0|                   2|                          2|                     16|                         0|                         0|                          0|                     0|                     0|                      0|               null| 0.3542247319929012| 0.6212263380626669|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     0.0|                     0.0|                     0.0|                     0.0|               -2536.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      1.0|                       1.0|                   0.0|            1.0|             0.0|                0.0|                2.0|                 3.0|                    0.0|                   0.0|                  0.0|                0.0|                           1.0|                  3.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100009|     0|           1|        171000.0| 1560726.0|    41301.0|      1395000.0|      0.035792000000000004|    -13778|        -3130|          -1213.0|           -619|       17.0|         1|             1|              0|               1|         1|         0|            3.0|                   2|                          2|                     16|                         0|                         0|                          0|                     0|                     0|                      0| 0.7747614130547695| 0.7239998516953141| 0.4920600938649263|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     1.0|                     0.0|                     1.0|                     0.0|               -1562.0|              0|              0|              0|              0|              0|              0|              1|              0|               0|               0|               0|               0|               1|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      1.0|                      1.0|                       2.0|                   0.0|            0.0|             1.0|                0.0|                0.0|                 1.0|                    1.0|                   0.0|                  0.0|                6.0|                           6.0|                  0.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100010|     0|           0|        360000.0| 1530000.0|    42075.0|      1530000.0|      0.003121999999999...|    -18850|         -449|          -4597.0|          -2379|        8.0|         1|             1|              1|               1|         0|         0|            2.0|                   3|                          3|                     16|                         0|                         0|                          0|                     0|                     1|                      1|               null| 0.7142792864482229| 0.5406544504453575|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     2.0|                     0.0|                     2.0|                     0.0|               -1070.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       0.0|                   0.0|            1.0|             1.0|                0.0|                0.0|                 3.0|                    1.0|                   0.0|                  0.0|                3.0|                           2.0|                  3.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100011|     0|           0|        112500.0| 1019610.0|    33826.5|       913500.0|                  0.018634|    -20099|       365243|          -7427.0|          -3514|       null|         1|             0|              0|               1|         0|         0|            2.0|                   2|                          2|                     14|                         0|                         0|                          0|                     0|                     0|                      0| 0.5873340468730377|0.20574728800732814| 0.7517237147741489|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     1.0|                     0.0|                     1.0|                     0.0|                   0.0|              0|              1|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       1.0|                   0.0|            0.0|             0.0|                0.0|                3.0|                 2.0|                    0.0|                   0.0|                  0.0|               18.0|                           1.0|                  1.0|                   4.0|               3.0|                   7.0|                    2.0|\n|    100012|     0|           0|        135000.0|  405000.0|    20250.0|       405000.0|      0.019688999999999998|    -14469|        -2019|         -14437.0|          -3992|       null|         1|             1|              0|               1|         0|         0|            1.0|                   2|                          2|                      8|                         0|                         0|                          0|                     0|                     0|                      0|               null| 0.7466436294590924|               null|          null|            null|                       null|              null|          null|         null|         null|         null|         null|        null|                null|          null|                   null|             null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|           null|             null|                        null|            null|           null|          null|          null|          null|          null|         null|                 null|           null|                    null|              null|          null|                     2.0|                     0.0|                     2.0|                     0.0|               -1673.0|              0|              0|              0|              0|              0|              0|              0|              0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|               0|                      null|                     null|                      null|                     null|                     null|                      null|                   1.0|            1.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                0.0|                           3.0|                 34.0|                   4.0|               3.0|                   7.0|                    2.0|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+-------------------+-------------------+-------------------+--------------+----------------+---------------------------+------------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683660713854_-329767327","id":"20230509-193153_544841159","dateCreated":"2023-05-09T19:31:53+0000","dateStarted":"2023-05-11T04:34:40+0000","dateFinished":"2023-05-11T04:46:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"%md\n\n#### Cast numerical values to float","user":"anonymous","dateUpdated":"2023-05-10T19:55:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Cast numerical values to float</h4>\n"}]},"apps":[],"jobName":"paragraph_1683748435378_1547597414","id":"20230510-195355_628700445","dateCreated":"2023-05-10T19:53:55+0000","dateStarted":"2023-05-10T19:55:07+0000","dateFinished":"2023-05-10T19:55:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"%python2\n\napp_data = app_data.select(*(F.col(c).cast(\"float\").alias(c) for c in app_data.columns))","user":"anonymous","dateUpdated":"2023-05-11T04:46:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1683748454498_-678529074","id":"20230510-195414_1749244716","dateCreated":"2023-05-10T19:54:14+0000","dateStarted":"2023-05-11T04:46:57+0000","dateFinished":"2023-05-11T04:46:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"%python2\n\napp_data.limit(1).show()","user":"anonymous","dateUpdated":"2023-05-11T04:47:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 119:>                                                        (0 + 1) / 1]\n\n                                                                                \n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n|sk_id_curr|target|cnt_children|amt_income_total|amt_credit|amt_annuity|amt_goods_price|region_population_relative|days_birth|days_employed|days_registration|days_id_publish|own_car_age|flag_mobil|flag_emp_phone|flag_work_phone|flag_cont_mobile|flag_phone|flag_email|cnt_fam_members|region_rating_client|region_rating_client_w_city|hour_appr_process_start|reg_region_not_live_region|reg_region_not_work_region|live_region_not_work_region|reg_city_not_live_city|reg_city_not_work_city|live_city_not_work_city|ext_source_1|ext_source_2|ext_source_3|apartments_avg|basementarea_avg|years_beginexpluatation_avg|years_build_avg|commonarea_avg|elevators_avg|entrances_avg|floorsmax_avg|floorsmin_avg|landarea_avg|livingapartments_avg|livingarea_avg|nonlivingapartments_avg|nonlivingarea_avg|apartments_mode|basementarea_mode|years_beginexpluatation_mode|years_build_mode|commonarea_mode|elevators_mode|entrances_mode|floorsmax_mode|floorsmin_mode|landarea_mode|livingapartments_mode|livingarea_mode|nonlivingapartments_mode|nonlivingarea_mode|apartments_medi|basementarea_medi|years_beginexpluatation_medi|years_build_medi|commonarea_medi|elevators_medi|entrances_medi|floorsmax_medi|floorsmin_medi|landarea_medi|livingapartments_medi|livingarea_medi|nonlivingapartments_medi|nonlivingarea_medi|totalarea_mode|obs_30_cnt_social_circle|def_30_cnt_social_circle|obs_60_cnt_social_circle|def_60_cnt_social_circle|days_last_phone_change|flag_document_2|flag_document_3|flag_document_4|flag_document_5|flag_document_6|flag_document_7|flag_document_8|flag_document_9|flag_document_10|flag_document_11|flag_document_12|flag_document_13|flag_document_14|flag_document_15|flag_document_16|flag_document_17|flag_document_18|flag_document_19|flag_document_20|flag_document_21|amt_req_credit_bureau_hour|amt_req_credit_bureau_day|amt_req_credit_bureau_week|amt_req_credit_bureau_mon|amt_req_credit_bureau_qrt|amt_req_credit_bureau_year|name_contract_type_enc|code_gender_enc|flag_own_car_enc|flag_own_realty_enc|name_type_suite_enc|name_income_type_enc|name_education_type_enc|name_family_status_enc|name_housing_type_enc|occupation_type_enc|weekday_appr_process_start_enc|organization_type_enc|fondkapremont_mode_enc|housetype_mode_enc|wallsmaterial_mode_enc|emergencystate_mode_enc|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n|  100002.0|   1.0|         0.0|        202500.0|  406597.5|    24700.5|       351000.0|                  0.018801|   -9461.0|       -637.0|          -3648.0|        -2120.0|       null|       1.0|           1.0|            0.0|             1.0|       1.0|       0.0|            1.0|                 2.0|                        2.0|                   10.0|                       0.0|                       0.0|                        0.0|                   0.0|                   0.0|                    0.0|  0.08303697|   0.2629486|  0.13937578|        0.0247|          0.0369|                     0.9722|         0.6192|        0.0143|          0.0|        0.069|       0.0833|        0.125|      0.0369|              0.0202|         0.019|                    0.0|              0.0|         0.0252|           0.0383|                      0.9722|          0.6341|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0377|                0.022|         0.0198|                     0.0|               0.0|          0.025|           0.0369|                      0.9722|          0.6243|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0375|               0.0205|         0.0193|                     0.0|               0.0|        0.0149|                     2.0|                     2.0|                     2.0|                     2.0|               -1134.0|            0.0|            1.0|            0.0|            0.0|            0.0|            0.0|            0.0|            0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       1.0|                   0.0|            1.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                0.0|                           1.0|                  0.0|                   0.0|               0.0|                   1.0|                    0.0|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683780434524_1143471736","id":"20230511-044714_233665273","dateCreated":"2023-05-11T04:47:14+0000","dateStarted":"2023-05-11T04:47:23+0000","dateFinished":"2023-05-11T04:47:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"text":"%md\n\n#### Imputation","user":"anonymous","dateUpdated":"2023-05-10T19:55:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Imputation</h4>\n"}]},"apps":[],"jobName":"paragraph_1683748486566_596559430","id":"20230510-195446_1259325990","dateCreated":"2023-05-10T19:54:46+0000","dateStarted":"2023-05-10T19:55:11+0000","dateFinished":"2023-05-10T19:55:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"%python2\n\nimputation_columns = list(set(app_data.columns) - set([\"sk_id_curr\"]))\n\nimputer = Imputer(\n    inputCols=imputation_columns,\n    outputCols=[\"{}_imputed\".format(c) for c in imputation_columns]\n    ).setStrategy(\"median\")\n\napp_data = imputer.fit(app_data).transform(app_data)\n\napp_data.limit(1).show()","user":"anonymous","dateUpdated":"2023-05-11T04:48:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... \n[Stage 121:>                                                        (0 + 1) / 1]\n\n[Stage 121:>                                                        (0 + 1) / 1]\n\n[Stage 121:>                                                        (0 + 1) / 1]\n\n[Stage 121:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 124:>                                                        (0 + 1) / 1]\n\n[Stage 125:>                                                        (0 + 1) / 1]\n\n                                                                                \n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|sk_id_curr|target|cnt_children|amt_income_total|amt_credit|amt_annuity|amt_goods_price|region_population_relative|days_birth|days_employed|days_registration|days_id_publish|own_car_age|flag_mobil|flag_emp_phone|flag_work_phone|flag_cont_mobile|flag_phone|flag_email|cnt_fam_members|region_rating_client|region_rating_client_w_city|hour_appr_process_start|reg_region_not_live_region|reg_region_not_work_region|live_region_not_work_region|reg_city_not_live_city|reg_city_not_work_city|live_city_not_work_city|ext_source_1|ext_source_2|ext_source_3|apartments_avg|basementarea_avg|years_beginexpluatation_avg|years_build_avg|commonarea_avg|elevators_avg|entrances_avg|floorsmax_avg|floorsmin_avg|landarea_avg|livingapartments_avg|livingarea_avg|nonlivingapartments_avg|nonlivingarea_avg|apartments_mode|basementarea_mode|years_beginexpluatation_mode|years_build_mode|commonarea_mode|elevators_mode|entrances_mode|floorsmax_mode|floorsmin_mode|landarea_mode|livingapartments_mode|livingarea_mode|nonlivingapartments_mode|nonlivingarea_mode|apartments_medi|basementarea_medi|years_beginexpluatation_medi|years_build_medi|commonarea_medi|elevators_medi|entrances_medi|floorsmax_medi|floorsmin_medi|landarea_medi|livingapartments_medi|livingarea_medi|nonlivingapartments_medi|nonlivingarea_medi|totalarea_mode|obs_30_cnt_social_circle|def_30_cnt_social_circle|obs_60_cnt_social_circle|def_60_cnt_social_circle|days_last_phone_change|flag_document_2|flag_document_3|flag_document_4|flag_document_5|flag_document_6|flag_document_7|flag_document_8|flag_document_9|flag_document_10|flag_document_11|flag_document_12|flag_document_13|flag_document_14|flag_document_15|flag_document_16|flag_document_17|flag_document_18|flag_document_19|flag_document_20|flag_document_21|amt_req_credit_bureau_hour|amt_req_credit_bureau_day|amt_req_credit_bureau_week|amt_req_credit_bureau_mon|amt_req_credit_bureau_qrt|amt_req_credit_bureau_year|name_contract_type_enc|code_gender_enc|flag_own_car_enc|flag_own_realty_enc|name_type_suite_enc|name_income_type_enc|name_education_type_enc|name_family_status_enc|name_housing_type_enc|occupation_type_enc|weekday_appr_process_start_enc|organization_type_enc|fondkapremont_mode_enc|housetype_mode_enc|wallsmaterial_mode_enc|emergencystate_mode_enc|nonlivingarea_avg_imputed|years_build_mode_imputed|amt_req_credit_bureau_mon_imputed|livingarea_mode_imputed|amt_credit_imputed|cnt_fam_members_imputed|flag_document_11_imputed|livingapartments_medi_imputed|entrances_medi_imputed|floorsmax_mode_imputed|emergencystate_mode_enc_imputed|basementarea_mode_imputed|flag_document_4_imputed|basementarea_avg_imputed|reg_city_not_live_city_imputed|nonlivingapartments_avg_imputed|def_30_cnt_social_circle_imputed|def_60_cnt_social_circle_imputed|flag_document_16_imputed|amt_annuity_imputed|amt_req_credit_bureau_day_imputed|livingapartments_mode_imputed|amt_income_total_imputed|days_registration_imputed|days_last_phone_change_imputed|own_car_age_imputed|fondkapremont_mode_enc_imputed|floorsmax_medi_imputed|flag_document_12_imputed|elevators_mode_imputed|region_rating_client_w_city_imputed|reg_city_not_work_city_imputed|flag_document_13_imputed|cnt_children_imputed|amt_req_credit_bureau_week_imputed|flag_document_20_imputed|days_id_publish_imputed|totalarea_mode_imputed|nonlivingarea_mode_imputed|commonarea_avg_imputed|hour_appr_process_start_imputed|flag_document_14_imputed|floorsmin_mode_imputed|flag_own_realty_enc_imputed|commonarea_medi_imputed|landarea_avg_imputed|flag_document_7_imputed|flag_document_6_imputed|amt_req_credit_bureau_year_imputed|live_region_not_work_region_imputed|landarea_mode_imputed|weekday_appr_process_start_enc_imputed|floorsmax_avg_imputed|ext_source_2_imputed|flag_cont_mobile_imputed|name_income_type_enc_imputed|reg_region_not_work_region_imputed|flag_document_8_imputed|flag_mobil_imputed|ext_source_1_imputed|livingarea_avg_imputed|name_education_type_enc_imputed|reg_region_not_live_region_imputed|obs_60_cnt_social_circle_imputed|wallsmaterial_mode_enc_imputed|nonlivingarea_medi_imputed|name_family_status_enc_imputed|apartments_avg_imputed|region_rating_client_imputed|live_city_not_work_city_imputed|flag_document_3_imputed|days_birth_imputed|apartments_medi_imputed|flag_document_9_imputed|entrances_mode_imputed|days_employed_imputed|code_gender_enc_imputed|flag_document_17_imputed|flag_email_imputed|years_build_avg_imputed|flag_phone_imputed|flag_emp_phone_imputed|years_beginexpluatation_medi_imputed|commonarea_mode_imputed|nonlivingapartments_medi_imputed|livingapartments_avg_imputed|flag_document_2_imputed|nonlivingapartments_mode_imputed|landarea_medi_imputed|flag_document_21_imputed|floorsmin_avg_imputed|years_beginexpluatation_mode_imputed|entrances_avg_imputed|years_beginexpluatation_avg_imputed|name_contract_type_enc_imputed|flag_document_19_imputed|apartments_mode_imputed|region_population_relative_imputed|housetype_mode_enc_imputed|flag_own_car_enc_imputed|amt_req_credit_bureau_hour_imputed|name_housing_type_enc_imputed|amt_req_credit_bureau_qrt_imputed|livingarea_medi_imputed|ext_source_3_imputed|elevators_avg_imputed|flag_work_phone_imputed|name_type_suite_enc_imputed|flag_document_15_imputed|flag_document_10_imputed|target_imputed|floorsmin_medi_imputed|basementarea_medi_imputed|elevators_medi_imputed|amt_goods_price_imputed|organization_type_enc_imputed|occupation_type_enc_imputed|obs_30_cnt_social_circle_imputed|flag_document_18_imputed|flag_document_5_imputed|years_build_medi_imputed|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|  100002.0|   1.0|         0.0|        202500.0|  406597.5|    24700.5|       351000.0|                  0.018801|   -9461.0|       -637.0|          -3648.0|        -2120.0|       null|       1.0|           1.0|            0.0|             1.0|       1.0|       0.0|            1.0|                 2.0|                        2.0|                   10.0|                       0.0|                       0.0|                        0.0|                   0.0|                   0.0|                    0.0|  0.08303697|   0.2629486|  0.13937578|        0.0247|          0.0369|                     0.9722|         0.6192|        0.0143|          0.0|        0.069|       0.0833|        0.125|      0.0369|              0.0202|         0.019|                    0.0|              0.0|         0.0252|           0.0383|                      0.9722|          0.6341|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0377|                0.022|         0.0198|                     0.0|               0.0|          0.025|           0.0369|                      0.9722|          0.6243|         0.0144|           0.0|         0.069|        0.0833|         0.125|       0.0375|               0.0205|         0.0193|                     0.0|               0.0|        0.0149|                     2.0|                     2.0|                     2.0|                     2.0|               -1134.0|            0.0|            1.0|            0.0|            0.0|            0.0|            0.0|            0.0|            0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|             0.0|                       0.0|                      0.0|                       0.0|                      0.0|                      0.0|                       1.0|                   0.0|            1.0|             0.0|                0.0|                0.0|                 0.0|                    0.0|                   1.0|                  0.0|                0.0|                           1.0|                  0.0|                   0.0|               0.0|                   1.0|                    0.0|                      0.0|                  0.6341|                              0.0|                 0.0198|          406597.5|                    1.0|                     0.0|                       0.0205|                 0.069|                0.0833|                            0.0|                   0.0383|                    0.0|                  0.0369|                           0.0|                            0.0|                             2.0|                             2.0|                     0.0|            24700.5|                              0.0|                        0.022|                202500.0|                  -3648.0|                       -1134.0|                9.0|                           0.0|                0.0833|                     0.0|                   0.0|                                2.0|                           0.0|                     0.0|                 0.0|                               0.0|                     0.0|                -2120.0|                0.0149|                       0.0|                0.0143|                           10.0|                     0.0|                 0.125|                        0.0|                 0.0144|              0.0369|                    0.0|                    0.0|                               1.0|                                0.0|               0.0377|                                   1.0|               0.0833|           0.2629486|                     1.0|                         0.0|                               0.0|                    0.0|               1.0|          0.08303697|                 0.019|                            0.0|                               0.0|                             2.0|                           1.0|                       0.0|                           1.0|                0.0247|                         2.0|                            0.0|                    1.0|           -9461.0|                  0.025|                    0.0|                 0.069|               -637.0|                    1.0|                     0.0|               0.0|                 0.6192|               1.0|                   1.0|                              0.9722|                 0.0144|                             0.0|                      0.0202|                    0.0|                             0.0|               0.0375|                     0.0|                0.125|                              0.9722|                0.069|                             0.9722|                           0.0|                     0.0|                 0.0252|                          0.018801|                       0.0|                     0.0|                               0.0|                          0.0|                              0.0|                 0.0193|          0.13937578|                  0.0|                    0.0|                        0.0|                     0.0|                     0.0|           1.0|                 0.125|                   0.0369|                   0.0|               351000.0|                          0.0|                        0.0|                             2.0|                     0.0|                    0.0|                  0.6243|\n+----------+------+------------+----------------+----------+-----------+---------------+--------------------------+----------+-------------+-----------------+---------------+-----------+----------+--------------+---------------+----------------+----------+----------+---------------+--------------------+---------------------------+-----------------------+--------------------------+--------------------------+---------------------------+----------------------+----------------------+-----------------------+------------+------------+------------+--------------+----------------+---------------------------+---------------+--------------+-------------+-------------+-------------+-------------+------------+--------------------+--------------+-----------------------+-----------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+---------------+-----------------+----------------------------+----------------+---------------+--------------+--------------+--------------+--------------+-------------+---------------------+---------------+------------------------+------------------+--------------+------------------------+------------------------+------------------------+------------------------+----------------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+----------------+--------------------------+-------------------------+--------------------------+-------------------------+-------------------------+--------------------------+----------------------+---------------+----------------+-------------------+-------------------+--------------------+-----------------------+----------------------+---------------------+-------------------+------------------------------+---------------------+----------------------+------------------+----------------------+-----------------------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683748502216_1856843585","id":"20230510-195502_1275992709","dateCreated":"2023-05-10T19:55:02+0000","dateStarted":"2023-05-11T04:48:04+0000","dateFinished":"2023-05-11T04:51:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"%md\n\n#### Drop old columns","user":"anonymous","dateUpdated":"2023-05-10T20:03:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Drop old columns</h4>\n"}]},"apps":[],"jobName":"paragraph_1683748996426_2042584238","id":"20230510-200316_634576390","dateCreated":"2023-05-10T20:03:16+0000","dateStarted":"2023-05-10T20:03:25+0000","dateFinished":"2023-05-10T20:03:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"%python2\n\napp_data = app_data.drop(*imputation_columns)\napp_data.limit(2).show()","user":"anonymous","dateUpdated":"2023-05-11T04:53:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 128:>                                                        (0 + 1) / 1]\n\n                                                                                \n+----------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|sk_id_curr|nonlivingarea_avg_imputed|years_build_mode_imputed|amt_req_credit_bureau_mon_imputed|livingarea_mode_imputed|amt_credit_imputed|cnt_fam_members_imputed|flag_document_11_imputed|livingapartments_medi_imputed|entrances_medi_imputed|floorsmax_mode_imputed|emergencystate_mode_enc_imputed|basementarea_mode_imputed|flag_document_4_imputed|basementarea_avg_imputed|reg_city_not_live_city_imputed|nonlivingapartments_avg_imputed|def_30_cnt_social_circle_imputed|def_60_cnt_social_circle_imputed|flag_document_16_imputed|amt_annuity_imputed|amt_req_credit_bureau_day_imputed|livingapartments_mode_imputed|amt_income_total_imputed|days_registration_imputed|days_last_phone_change_imputed|own_car_age_imputed|fondkapremont_mode_enc_imputed|floorsmax_medi_imputed|flag_document_12_imputed|elevators_mode_imputed|region_rating_client_w_city_imputed|reg_city_not_work_city_imputed|flag_document_13_imputed|cnt_children_imputed|amt_req_credit_bureau_week_imputed|flag_document_20_imputed|days_id_publish_imputed|totalarea_mode_imputed|nonlivingarea_mode_imputed|commonarea_avg_imputed|hour_appr_process_start_imputed|flag_document_14_imputed|floorsmin_mode_imputed|flag_own_realty_enc_imputed|commonarea_medi_imputed|landarea_avg_imputed|flag_document_7_imputed|flag_document_6_imputed|amt_req_credit_bureau_year_imputed|live_region_not_work_region_imputed|landarea_mode_imputed|weekday_appr_process_start_enc_imputed|floorsmax_avg_imputed|ext_source_2_imputed|flag_cont_mobile_imputed|name_income_type_enc_imputed|reg_region_not_work_region_imputed|flag_document_8_imputed|flag_mobil_imputed|ext_source_1_imputed|livingarea_avg_imputed|name_education_type_enc_imputed|reg_region_not_live_region_imputed|obs_60_cnt_social_circle_imputed|wallsmaterial_mode_enc_imputed|nonlivingarea_medi_imputed|name_family_status_enc_imputed|apartments_avg_imputed|region_rating_client_imputed|live_city_not_work_city_imputed|flag_document_3_imputed|days_birth_imputed|apartments_medi_imputed|flag_document_9_imputed|entrances_mode_imputed|days_employed_imputed|code_gender_enc_imputed|flag_document_17_imputed|flag_email_imputed|years_build_avg_imputed|flag_phone_imputed|flag_emp_phone_imputed|years_beginexpluatation_medi_imputed|commonarea_mode_imputed|nonlivingapartments_medi_imputed|livingapartments_avg_imputed|flag_document_2_imputed|nonlivingapartments_mode_imputed|landarea_medi_imputed|flag_document_21_imputed|floorsmin_avg_imputed|years_beginexpluatation_mode_imputed|entrances_avg_imputed|years_beginexpluatation_avg_imputed|name_contract_type_enc_imputed|flag_document_19_imputed|apartments_mode_imputed|region_population_relative_imputed|housetype_mode_enc_imputed|flag_own_car_enc_imputed|amt_req_credit_bureau_hour_imputed|name_housing_type_enc_imputed|amt_req_credit_bureau_qrt_imputed|livingarea_medi_imputed|ext_source_3_imputed|elevators_avg_imputed|flag_work_phone_imputed|name_type_suite_enc_imputed|flag_document_15_imputed|flag_document_10_imputed|target_imputed|floorsmin_medi_imputed|basementarea_medi_imputed|elevators_medi_imputed|amt_goods_price_imputed|organization_type_enc_imputed|occupation_type_enc_imputed|obs_30_cnt_social_circle_imputed|flag_document_18_imputed|flag_document_5_imputed|years_build_medi_imputed|\n+----------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|  100002.0|                      0.0|                  0.6341|                              0.0|                 0.0198|          406597.5|                    1.0|                     0.0|                       0.0205|                 0.069|                0.0833|                            0.0|                   0.0383|                    0.0|                  0.0369|                           0.0|                            0.0|                             2.0|                             2.0|                     0.0|            24700.5|                              0.0|                        0.022|                202500.0|                  -3648.0|                       -1134.0|                9.0|                           0.0|                0.0833|                     0.0|                   0.0|                                2.0|                           0.0|                     0.0|                 0.0|                               0.0|                     0.0|                -2120.0|                0.0149|                       0.0|                0.0143|                           10.0|                     0.0|                 0.125|                        0.0|                 0.0144|              0.0369|                    0.0|                    0.0|                               1.0|                                0.0|               0.0377|                                   1.0|               0.0833|           0.2629486|                     1.0|                         0.0|                               0.0|                    0.0|               1.0|          0.08303697|                 0.019|                            0.0|                               0.0|                             2.0|                           1.0|                       0.0|                           1.0|                0.0247|                         2.0|                            0.0|                    1.0|           -9461.0|                  0.025|                    0.0|                 0.069|               -637.0|                    1.0|                     0.0|               0.0|                 0.6192|               1.0|                   1.0|                              0.9722|                 0.0144|                             0.0|                      0.0202|                    0.0|                             0.0|               0.0375|                     0.0|                0.125|                              0.9722|                0.069|                             0.9722|                           0.0|                     0.0|                 0.0252|                          0.018801|                       0.0|                     0.0|                               0.0|                          0.0|                              0.0|                 0.0193|          0.13937578|                  0.0|                    0.0|                        0.0|                     0.0|                     0.0|           1.0|                 0.125|                   0.0369|                   0.0|               351000.0|                          0.0|                        0.0|                             2.0|                     0.0|                    0.0|                  0.6243|\n|  100003.0|                   0.0098|                   0.804|                              0.0|                 0.0554|         1293502.5|                    2.0|                     0.0|                       0.0787|                0.0345|                0.2917|                            0.0|                   0.0538|                    0.0|                  0.0529|                           0.0|                         0.0039|                             0.0|                             0.0|                     0.0|            35698.5|                              0.0|                        0.079|                270000.0|                  -1186.0|                        -828.0|                9.0|                           0.0|                0.2917|                     0.0|                0.0806|                                1.0|                           0.0|                     0.0|                 0.0|                               0.0|                     0.0|                 -291.0|                0.0714|                       0.0|                0.0605|                           11.0|                     0.0|                0.3333|                        1.0|                 0.0608|               0.013|                    0.0|                    0.0|                               0.0|                                0.0|               0.0128|                                   2.0|               0.2917|           0.6222458|                     1.0|                         3.0|                               0.0|                    0.0|               1.0|          0.31126732|                0.0549|                            1.0|                               0.0|                             1.0|                           2.0|                      0.01|                           0.0|                0.0959|                         1.0|                            0.0|                    1.0|          -16765.0|                 0.0968|                    0.0|                0.0345|              -1188.0|                    0.0|                     0.0|               0.0|                  0.796|               1.0|                   1.0|                              0.9851|                 0.0497|                          0.0039|                      0.0773|                    0.0|                             0.0|               0.0132|                     0.0|               0.3333|                              0.9851|               0.0345|                             0.9851|                           0.0|                     0.0|                 0.0924|                          0.003541|                       0.0|                     0.0|                               0.0|                          0.0|                              0.0|                 0.0558|          0.53527623|                 0.08|                    0.0|                        1.0|                     0.0|                     0.0|           0.0|                0.3333|                   0.0529|                  0.08|              1129500.0|                          7.0|                        2.0|                             1.0|                     0.0|                    0.0|                  0.7987|\n+----------+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683749008074_614396320","id":"20230510-200328_344298064","dateCreated":"2023-05-10T20:03:28+0000","dateStarted":"2023-05-11T04:53:54+0000","dateFinished":"2023-05-11T04:54:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%python2\n\napp_data = app_data.drop(\"sk_id_curr\")\napp_data.limit(2).show()","user":"anonymous","dateUpdated":"2023-05-11T04:54:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 130:>                                                        (0 + 1) / 1]\n\n                                                                                \n+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|nonlivingarea_avg_imputed|years_build_mode_imputed|amt_req_credit_bureau_mon_imputed|livingarea_mode_imputed|amt_credit_imputed|cnt_fam_members_imputed|flag_document_11_imputed|livingapartments_medi_imputed|entrances_medi_imputed|floorsmax_mode_imputed|emergencystate_mode_enc_imputed|basementarea_mode_imputed|flag_document_4_imputed|basementarea_avg_imputed|reg_city_not_live_city_imputed|nonlivingapartments_avg_imputed|def_30_cnt_social_circle_imputed|def_60_cnt_social_circle_imputed|flag_document_16_imputed|amt_annuity_imputed|amt_req_credit_bureau_day_imputed|livingapartments_mode_imputed|amt_income_total_imputed|days_registration_imputed|days_last_phone_change_imputed|own_car_age_imputed|fondkapremont_mode_enc_imputed|floorsmax_medi_imputed|flag_document_12_imputed|elevators_mode_imputed|region_rating_client_w_city_imputed|reg_city_not_work_city_imputed|flag_document_13_imputed|cnt_children_imputed|amt_req_credit_bureau_week_imputed|flag_document_20_imputed|days_id_publish_imputed|totalarea_mode_imputed|nonlivingarea_mode_imputed|commonarea_avg_imputed|hour_appr_process_start_imputed|flag_document_14_imputed|floorsmin_mode_imputed|flag_own_realty_enc_imputed|commonarea_medi_imputed|landarea_avg_imputed|flag_document_7_imputed|flag_document_6_imputed|amt_req_credit_bureau_year_imputed|live_region_not_work_region_imputed|landarea_mode_imputed|weekday_appr_process_start_enc_imputed|floorsmax_avg_imputed|ext_source_2_imputed|flag_cont_mobile_imputed|name_income_type_enc_imputed|reg_region_not_work_region_imputed|flag_document_8_imputed|flag_mobil_imputed|ext_source_1_imputed|livingarea_avg_imputed|name_education_type_enc_imputed|reg_region_not_live_region_imputed|obs_60_cnt_social_circle_imputed|wallsmaterial_mode_enc_imputed|nonlivingarea_medi_imputed|name_family_status_enc_imputed|apartments_avg_imputed|region_rating_client_imputed|live_city_not_work_city_imputed|flag_document_3_imputed|days_birth_imputed|apartments_medi_imputed|flag_document_9_imputed|entrances_mode_imputed|days_employed_imputed|code_gender_enc_imputed|flag_document_17_imputed|flag_email_imputed|years_build_avg_imputed|flag_phone_imputed|flag_emp_phone_imputed|years_beginexpluatation_medi_imputed|commonarea_mode_imputed|nonlivingapartments_medi_imputed|livingapartments_avg_imputed|flag_document_2_imputed|nonlivingapartments_mode_imputed|landarea_medi_imputed|flag_document_21_imputed|floorsmin_avg_imputed|years_beginexpluatation_mode_imputed|entrances_avg_imputed|years_beginexpluatation_avg_imputed|name_contract_type_enc_imputed|flag_document_19_imputed|apartments_mode_imputed|region_population_relative_imputed|housetype_mode_enc_imputed|flag_own_car_enc_imputed|amt_req_credit_bureau_hour_imputed|name_housing_type_enc_imputed|amt_req_credit_bureau_qrt_imputed|livingarea_medi_imputed|ext_source_3_imputed|elevators_avg_imputed|flag_work_phone_imputed|name_type_suite_enc_imputed|flag_document_15_imputed|flag_document_10_imputed|target_imputed|floorsmin_medi_imputed|basementarea_medi_imputed|elevators_medi_imputed|amt_goods_price_imputed|organization_type_enc_imputed|occupation_type_enc_imputed|obs_30_cnt_social_circle_imputed|flag_document_18_imputed|flag_document_5_imputed|years_build_medi_imputed|\n+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n|                      0.0|                  0.6341|                              0.0|                 0.0198|          406597.5|                    1.0|                     0.0|                       0.0205|                 0.069|                0.0833|                            0.0|                   0.0383|                    0.0|                  0.0369|                           0.0|                            0.0|                             2.0|                             2.0|                     0.0|            24700.5|                              0.0|                        0.022|                202500.0|                  -3648.0|                       -1134.0|                9.0|                           0.0|                0.0833|                     0.0|                   0.0|                                2.0|                           0.0|                     0.0|                 0.0|                               0.0|                     0.0|                -2120.0|                0.0149|                       0.0|                0.0143|                           10.0|                     0.0|                 0.125|                        0.0|                 0.0144|              0.0369|                    0.0|                    0.0|                               1.0|                                0.0|               0.0377|                                   1.0|               0.0833|           0.2629486|                     1.0|                         0.0|                               0.0|                    0.0|               1.0|          0.08303697|                 0.019|                            0.0|                               0.0|                             2.0|                           1.0|                       0.0|                           1.0|                0.0247|                         2.0|                            0.0|                    1.0|           -9461.0|                  0.025|                    0.0|                 0.069|               -637.0|                    1.0|                     0.0|               0.0|                 0.6192|               1.0|                   1.0|                              0.9722|                 0.0144|                             0.0|                      0.0202|                    0.0|                             0.0|               0.0375|                     0.0|                0.125|                              0.9722|                0.069|                             0.9722|                           0.0|                     0.0|                 0.0252|                          0.018801|                       0.0|                     0.0|                               0.0|                          0.0|                              0.0|                 0.0193|          0.13937578|                  0.0|                    0.0|                        0.0|                     0.0|                     0.0|           1.0|                 0.125|                   0.0369|                   0.0|               351000.0|                          0.0|                        0.0|                             2.0|                     0.0|                    0.0|                  0.6243|\n|                   0.0098|                   0.804|                              0.0|                 0.0554|         1293502.5|                    2.0|                     0.0|                       0.0787|                0.0345|                0.2917|                            0.0|                   0.0538|                    0.0|                  0.0529|                           0.0|                         0.0039|                             0.0|                             0.0|                     0.0|            35698.5|                              0.0|                        0.079|                270000.0|                  -1186.0|                        -828.0|                9.0|                           0.0|                0.2917|                     0.0|                0.0806|                                1.0|                           0.0|                     0.0|                 0.0|                               0.0|                     0.0|                 -291.0|                0.0714|                       0.0|                0.0605|                           11.0|                     0.0|                0.3333|                        1.0|                 0.0608|               0.013|                    0.0|                    0.0|                               0.0|                                0.0|               0.0128|                                   2.0|               0.2917|           0.6222458|                     1.0|                         3.0|                               0.0|                    0.0|               1.0|          0.31126732|                0.0549|                            1.0|                               0.0|                             1.0|                           2.0|                      0.01|                           0.0|                0.0959|                         1.0|                            0.0|                    1.0|          -16765.0|                 0.0968|                    0.0|                0.0345|              -1188.0|                    0.0|                     0.0|               0.0|                  0.796|               1.0|                   1.0|                              0.9851|                 0.0497|                          0.0039|                      0.0773|                    0.0|                             0.0|               0.0132|                     0.0|               0.3333|                              0.9851|               0.0345|                             0.9851|                           0.0|                     0.0|                 0.0924|                          0.003541|                       0.0|                     0.0|                               0.0|                          0.0|                              0.0|                 0.0558|          0.53527623|                 0.08|                    0.0|                        1.0|                     0.0|                     0.0|           0.0|                0.3333|                   0.0529|                  0.08|              1129500.0|                          7.0|                        2.0|                             1.0|                     0.0|                    0.0|                  0.7987|\n+-------------------------+------------------------+---------------------------------+-----------------------+------------------+-----------------------+------------------------+-----------------------------+----------------------+----------------------+-------------------------------+-------------------------+-----------------------+------------------------+------------------------------+-------------------------------+--------------------------------+--------------------------------+------------------------+-------------------+---------------------------------+-----------------------------+------------------------+-------------------------+------------------------------+-------------------+------------------------------+----------------------+------------------------+----------------------+-----------------------------------+------------------------------+------------------------+--------------------+----------------------------------+------------------------+-----------------------+----------------------+--------------------------+----------------------+-------------------------------+------------------------+----------------------+---------------------------+-----------------------+--------------------+-----------------------+-----------------------+----------------------------------+-----------------------------------+---------------------+--------------------------------------+---------------------+--------------------+------------------------+----------------------------+----------------------------------+-----------------------+------------------+--------------------+----------------------+-------------------------------+----------------------------------+--------------------------------+------------------------------+--------------------------+------------------------------+----------------------+----------------------------+-------------------------------+-----------------------+------------------+-----------------------+-----------------------+----------------------+---------------------+-----------------------+------------------------+------------------+-----------------------+------------------+----------------------+------------------------------------+-----------------------+--------------------------------+----------------------------+-----------------------+--------------------------------+---------------------+------------------------+---------------------+------------------------------------+---------------------+-----------------------------------+------------------------------+------------------------+-----------------------+----------------------------------+--------------------------+------------------------+----------------------------------+-----------------------------+---------------------------------+-----------------------+--------------------+---------------------+-----------------------+---------------------------+------------------------+------------------------+--------------+----------------------+-------------------------+----------------------+-----------------------+-----------------------------+---------------------------+--------------------------------+------------------------+-----------------------+------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1683749055154_1301835336","id":"20230510-200415_1106213453","dateCreated":"2023-05-10T20:04:15+0000","dateStarted":"2023-05-11T04:54:20+0000","dateFinished":"2023-05-11T04:54:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"%md\n\n#### Data normalization","user":"anonymous","dateUpdated":"2023-05-10T20:05:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":true,"language":"markdown"},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Data normalization</h4>\n"}]},"apps":[],"jobName":"paragraph_1683749090838_969225107","id":"20230510-200450_219246690","dateCreated":"2023-05-10T20:04:50+0000","dateStarted":"2023-05-10T20:05:09+0000","dateFinished":"2023-05-10T20:05:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%python2\n\nto_transform_cols = list(set(app_data.columns) - set([\"target_imputed\"]))\n\nVector assembler\nassembler = [\n    VectorAssembler(\n        inputCols=[col],\n        outputCol=col + \"_vec\"\n    ) for col in to_transform_cols\n]\nscalers = [\n    MinMaxScaler(\n        inputCol=col + \"_vec\",\n        outputCol=col + \"_scaled\"\n    ) for col in to_transform_cols\n]\n\npipeline = Pipeline(stages=assembler + scalers)\nmodel = pipeline.fit(app_data)\ndata = model.transform(app_data)","user":"anonymous","dateUpdated":"2023-05-11T04:55:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"  File \"<stdin>\", line 1\n    Vector assembler\n                   ^\nSyntaxError: invalid syntax\n          \n[Stage 132:>                                                        (0 + 1) / 1]\n\n[Stage 132:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 134:>                                                        (0 + 1) / 1]\n\n[Stage 134:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 136:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 138:>                                                        (0 + 1) / 1]\n\n[Stage 138:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 140:>                                                        (0 + 1) / 1]\n\n[Stage 140:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 142:>                                                        (0 + 1) / 1]\n\n[Stage 142:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 144:>                                                        (0 + 1) / 1]\n\n[Stage 144:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 146:>                                                        (0 + 1) / 1]\n\n[Stage 146:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 148:>                                                        (0 + 1) / 1]\n\n[Stage 148:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 150:>                                                        (0 + 1) / 1]\n\n[Stage 150:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 152:>                                                        (0 + 1) / 1]\n\n[Stage 152:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 154:>                                                        (0 + 1) / 1]\n\n[Stage 154:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 156:>                                                        (0 + 1) / 1]\n\n[Stage 156:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 158:>                                                        (0 + 1) / 1]\n\n[Stage 158:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 160:>                                                        (0 + 1) / 1]\n\n[Stage 160:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 162:>                                                        (0 + 1) / 1]\n\n[Stage 162:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 164:>                                                        (0 + 1) / 1]\n\n[Stage 164:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 166:>                                                        (0 + 1) / 1]\n\n[Stage 166:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 168:>                                                        (0 + 1) / 1]\n\n[Stage 168:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 170:>                                                        (0 + 1) / 1]\n\n[Stage 170:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 172:>                                                        (0 + 1) / 1]\n\n[Stage 172:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 174:>                                                        (0 + 1) / 1]\n\n[Stage 174:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 176:>                                                        (0 + 1) / 1]\n\n[Stage 176:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 178:>                                                        (0 + 1) / 1]\n\n[Stage 178:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 180:>                                                        (0 + 1) / 1]\n\n[Stage 180:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 182:>                                                        (0 + 1) / 1]\n\n[Stage 182:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 184:>                                                        (0 + 1) / 1]\n\n[Stage 184:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 186:>                                                        (0 + 1) / 1]\n\n[Stage 186:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 188:>                                                        (0 + 1) / 1]\n\n[Stage 188:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 190:>                                                        (0 + 1) / 1]\n\n[Stage 190:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 192:>                                                        (0 + 1) / 1]\n\n[Stage 192:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 194:>                                                        (0 + 1) / 1]\n\n[Stage 194:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 196:>                                                        (0 + 1) / 1]\n\n[Stage 196:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 198:>                                                        (0 + 1) / 1]\n\n[Stage 198:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 200:>                                                        (0 + 1) / 1]\n\n[Stage 200:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 202:>                                                        (0 + 1) / 1]\n\n[Stage 202:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 204:>                                                        (0 + 1) / 1]\n\n[Stage 204:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 206:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 208:>                                                        (0 + 1) / 1]\n\n[Stage 208:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 210:>                                                        (0 + 1) / 1]\n\n[Stage 210:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 212:>                                                        (0 + 1) / 1]\n\n[Stage 212:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 214:>                                                        (0 + 1) / 1]\n\n[Stage 214:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 216:>                                                        (0 + 1) / 1]\n\n[Stage 216:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 218:>                                                        (0 + 1) / 1]\n\n[Stage 218:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 220:>                                                        (0 + 1) / 1]\n\n[Stage 220:>                                                        (0 + 1) / 1]\n\n                                                                                \n\n[Stage 222:>                                                        (0 + 1) / 1]\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 129, in fit\n    return self._fit(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/pipeline.py\", line 109, in _fit\n    model = stage.fit(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 129, in fit\n    return self._fit(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 321, in _fit\n    java_model = self._fit_java(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 318, in _fit_java\n    return self._java_obj.fit(dataset._jdf)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1303, in __call__\n    answer = self.gateway_client.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1033, in send_command\n    response = connection.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1200, in send_command\n    answer = smart_decode(self.stream.readline()[:-1])\n  File \"/usr/lib64/python2.7/socket.py\", line 447, in readline\n    data = self._sock.recv(self._rbufsize)\n  File \"/usr/lib/python2.7/site-packages/pyspark/context.py\", line 281, in signal_handler\n    raise KeyboardInterrupt()\nKeyboardInterrupt\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'model' is not defined\n"}]},"apps":[],"jobName":"paragraph_1683749110156_-743646348","id":"20230510-200510_947427191","dateCreated":"2023-05-10T20:05:10+0000","dateStarted":"2023-05-11T04:55:59+0000","dateFinished":"2023-05-11T05:55:41+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%python2\n\ndata.limit(5).show()","user":"anonymous","dateUpdated":"2023-05-11T04:56:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683780996842_-338368133","id":"20230511-045636_2059749995","dateCreated":"2023-05-11T04:56:36+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"%python2\n\nto_drop_cols = set(data.columns) - set([\"target_imputed\"])\nto_drop_cols = list(\n    filter(lambda x: not x[::-1].startswith(\"scaled\"[::-1]), to_drop_cols)\n)\ndata = data.drop(*to_drop_cols)\ndata = data.withColumnRenamed(\"target_imputed\", \"label\")","user":"anonymous","dateUpdated":"2023-05-11T04:56:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778775863_1812774479","id":"20230511-041935_1613722778","dateCreated":"2023-05-11T04:19:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"%python2\n\ndata.limit(5).show()","user":"anonymous","dateUpdated":"2023-05-11T04:20:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778795254_124511629","id":"20230511-041955_635000415","dateCreated":"2023-05-11T04:19:55+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"%python2\n\nfeature_cols = list(set(data.columns) - set([\"label\"]))\n\nassembler = VectorAssembler(\n    inputCols=feature_cols,\n    outputCol=\"features\"\n)\n\npipeline = Pipeline(stages=[assembler, pca])\nmodel = pipeline.fit(data)\ndata = model.transform(data)","user":"anonymous","dateUpdated":"2023-05-11T04:20:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778830887_-777847135","id":"20230511-042030_1108204444","dateCreated":"2023-05-11T04:20:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"%python2\n\ndf = data.select([\"label\", \"features\"])","user":"anonymous","dateUpdated":"2023-05-11T04:21:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778894186_1267554639","id":"20230511-042134_63437168","dateCreated":"2023-05-11T04:21:34+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"%python2\n\ntrain_data, test_data = df.randomSplit([0.7, 0.3], seed=42)","user":"anonymous","dateUpdated":"2023-05-11T04:21:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778903730_694494961","id":"20230511-042143_1213021835","dateCreated":"2023-05-11T04:21:43+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"%python2\n\nroc_evaluator = BinaryClassificationEvaluator(\n    labelCol=\"label\",\n    rawPredictionCol=\"prediction\",\n    metricName=\"areaUnderROC\"\n)\n\npr_evaluator = BinaryClassificationEvaluator(\n    labelCol=\"label\",\n    rawPredictionCol=\"prediction\",\n    metricName=\"areaUnderPR\"\n)","user":"anonymous","dateUpdated":"2023-05-11T04:21:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778914586_2054228222","id":"20230511-042154_1478607725","dateCreated":"2023-05-11T04:21:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"%python2\n\nlr = LogisticRegression()\ngrid = ParamGridBuilder() \\\n    .addGrid(lr.regParam, [0.0, 0.1, 1.0]) \\\n    .addGrid(lr.elasticNetParam, [0.0, 1.0]) \\\n    .build()\ncv = CrossValidator(\n    estimator=lr,\n    estimatorParamMaps=grid,\n    evaluator=roc_evaluator,\n    parallelism=2,\n    numFolds=4\n)\ncvModel = cv.fit(train_data)\n\n# Predict data\npredictions = cvModel.transform(test_data)\n\n# Evaluation\nroc = roc_evaluator.evaluate(predictions)\nprint(\"Area under ROC curve on test data Logistic Regression = %g\" % roc)\n\npr = pr_evaluator.evaluate(predictions)\nprint(\"Area under PR curve on test data Logistic regression = %g\" % pr)","user":"anonymous","dateUpdated":"2023-05-11T04:23:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683778930804_-89192576","id":"20230511-042210_33306318","dateCreated":"2023-05-11T04:22:10+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"%python2\n\nlr_best_model = cvModel.bestmodel\nlr_best_model.save(\"models/lr\")\n\npredictions.coalesce(1)\\\n    .select(\"prediction\",'label')\\\n    .write\\\n    .mode(\"overwrite\")\\\n    .format(\"csv\")\\\n    .option(\"sep\", \",\")\\\n    .option(\"header\",\"true\")\\\n    .csv(\"output/lr_predictions.csv\")\n    \nspark.createDataFrame(\n    data=[[\"ROC\", roc], [\"PR\", pr], schema=[\"metric\", \"value\"]\n).coalesce(1).write.mode(\"overwrite\").format(\"csv\").option(\n    \"sep\", \",\"\n).option(\"header\", \"true\").csv(\"output/lr_scores\")","user":"anonymous","dateUpdated":"2023-05-11T05:41:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683782962338_1573051246","id":"20230511-052922_382324881","dateCreated":"2023-05-11T05:29:22+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"%python2\n\ndt = DecisionTreeClassifier()\ngrid = ParamGridBuilder() \\\n    .addGrid(dt.maxDepth, [5, 10, 20]) \\\n    .addGrid(dt.maxBins, [32, 64]) \\\n    .build()\ncv = CrossValidator(\n    estimator=dt,\n    estimatorParamMaps=grid,\n    evaluator=roc_evaluator,\n    parallelism=2,\n    numFolds=4\n)\ncvModel = cv.fit(train_data)\n\n# Predict data\npredictions = cvModel.transform(test_data)\n\n# Evaluate\nroc = roc_evaluator.evaluate(predictions)\nprint(\"Area under ROC on test data Decision Tree Classifier = %g\" % roc)\n\npr = pr_evaluator.evaluate(predictions)\nprint(\"Area under PR on test data Decision Tree Classifier = %g\" % pr)","user":"anonymous","dateUpdated":"2023-05-11T04:25:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683779022131_-1634454717","id":"20230511-042342_1670300452","dateCreated":"2023-05-11T04:23:42+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"%python2\n\ndt_best_model = cvModel.bestmodel\ndt_best_model.save(\"models/dt\")\n\npredictions.coalesce(1)\\\n    .select(\"prediction\",'label')\\\n    .write\\\n    .mode(\"overwrite\")\\\n    .format(\"csv\")\\\n    .option(\"sep\", \",\")\\\n    .option(\"header\",\"true\")\\\n    .csv(\"output/dt_predictions.csv\")\n\nspark.createDataFrame(\n    data=[[\"ROC\", roc], [\"PR\", pr], schema=[\"metric\", \"value\"]\n).coalesce(1).write.mode(\"overwrite\").format(\"csv\").option(\n    \"sep\", \",\"\n).option(\"header\", \"true\").csv(\"output/dt_scores\")","user":"anonymous","dateUpdated":"2023-05-11T05:40:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683783054590_917377824","id":"20230511-053054_1034227312","dateCreated":"2023-05-11T05:30:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"%python2\n","user":"anonymous","dateUpdated":"2023-05-09T19:17:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683659862623_-1043318362","id":"20230509-191742_386383754","dateCreated":"2023-05-09T19:17:42+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"%python2\n","user":"anonymous","dateUpdated":"2023-05-09T19:10:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683659429054_1163174420","id":"20230509-191029_492337009","dateCreated":"2023-05-09T19:10:29+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%python2\n","user":"anonymous","dateUpdated":"2023-05-09T19:10:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683659431746_1789545630","id":"20230509-191031_1917538175","dateCreated":"2023-05-09T19:10:31+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:360"}],"name":"Project","id":"2HY9W8T9P","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2HZ499UEU:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}